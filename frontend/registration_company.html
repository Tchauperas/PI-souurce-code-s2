<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Cadastro de Empresa</title>
    <link rel="stylesheet" href="css/styles_registration.css" />
    <link rel="icon" href="images/logo_hitsys.ico" type="image/x-icon" />
  </head>

  <body>
    <div class="barra-superior"></div>
    <h2>Cadastro de Empresa</h2>
    <div class="container">
      <form id="empresaForm">
        <label for="razao_social">Razão Social</label>
        <input type="text" id="razao_social" name="razao_social" required />

        <label for="cnpj">CNPJ</label>
        <input type="text" id="cnpj" name="cnpj" required />

        <label for="logradouro">Logradouro</label>
        <input type="text" id="logradouro" name="logradouro" />

        <label for="bairro">Bairro</label>
        <input type="text" id="bairro" name="bairro" />

        <label for="n">Número</label>
        <input type="text" id="n" name="n" />

        <label for="complemento">Complemento</label>
        <input type="text" id="complemento" name="complemento" />

        <label for="cep">CEP</label>
        <input type="text" id="cep" name="cep" />

        <label for="municipio">Município</label>
        <input type="text" id="municipio" name="municipio" />

        <label for="uf">UF</label>
        <select id="uf" name="uf">
          <option value="">Selecione</option>
          <option value="AC">AC</option>
          <option value="AL">AL</option>
          <option value="AP">AP</option>
          <option value="AM">AM</option>
          <option value="BA">BA</option>
          <option value="CE">CE</option>
          <option value="DF">DF</option>
          <option value="ES">ES</option>
          <option value="GO">GO</option>
          <option value="MA">MA</option>
          <option value="MT">MT</option>
          <option value="MS">MS</option>
          <option value="MG">MG</option>
          <option value="PA">PA</option>
          <option value="PB">PB</option>
          <option value="PR">PR</option>
          <option value="PE">PE</option>
          <option value="PI">PI</option>
          <option value="RJ">RJ</option>
          <option value="RN">RN</option>
          <option value="RS">RS</option>
          <option value="RO">RO</option>
          <option value="RR">RR</option>
          <option value="SC">SC</option>
          <option value="SP">SP</option>
          <option value="SE">SE</option>
          <option value="TO">TO</option>
        </select>

        <label for="telefone">Telefone</label>
        <input type="text" id="telefone" name="telefone" />
        <div class="buttoncontainer">
          <button class="buttonesquerda" type="submit">Cadastrar</button>
          <button
            class="buttondireita"
            type="button"
            onclick="window.location.href='company_listing_screen.html'"
          >
            Cancelar
          </button>
        </div>
      </form>
    </div>
    <div class="barra-inferior"></div>

    <script>
      document
        .getElementById("empresaForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = {
            razao_social: document.getElementById("razao_social").value,
            cnpj: document.getElementById("cnpj").value,
            logradouro: document.getElementById("logradouro").value,
            bairro: document.getElementById("bairro").value,
            n: document.getElementById("n").value,
            complemento: document.getElementById("complemento").value,
            cep: document.getElementById("cep").value,
            municipio: document.getElementById("municipio").value,
            uf: document.getElementById("uf").value,
            telefone: document.getElementById("telefone").value,
            id_usuario: "1"
          };

          console.log("Dados do formulário:", formData);

          fetch("http://localhost:3000/empresa", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${localStorage.getItem("authToken")}`,
            },
            body: JSON.stringify(formData),
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error("Erro na requisição");
              }
              return response.json();
            })
            .then((data) => {
              alert("Empresa cadastrada com sucesso!");
              window.location.href = "company_listing_screen.html";
            })
            .catch((error) => {
              console.error("Erro:", error);
              alert("Erro ao cadastrar empresa: " + error.message);
            });
        });
    </script>
  </body>
</html>
